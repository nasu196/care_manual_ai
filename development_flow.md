# 開発フロー案

このドキュメントは、介護施設向け特化型AIツールの初期開発フェーズにおける進め方の案をまとめたものです。
`project_todos.md` と合わせて参照してください。

## フェーズ 0: 準備・基盤構築

このフェーズの目標は、開発を開始するための基本的な環境を整え、主要技術の簡単な検証を行うことです。

1.  **バージョン管理・リポジトリ作成 (`project_todos.md` No. 79, 80):**
    *   GitHubに専用リポジトリを作成します。
    *   基本的なブランチ戦略（例: main, develop）を決定します。
2.  **開発環境構築:**
    *   各開発者のローカル開発環境をセットアップします (Node.js, pnpm/npm/yarn, VSCode拡張機能など)。
3.  **クラウドサービスセットアップ:**
    *   **Supabaseプロジェクト作成 (`project_todos.md` No. 65):**
        *   データベース、ストレージ、Edge Functionsの初期設定を行います。
    *   **Vercelプロジェクト作成 (`project_todos.md` No. 78):**
        *   Next.jsアプリケーションのデプロイ先として設定します。GitHubリポジトリと連携します。(注: ローンチ時またはデプロイと動作確認が必要になったタイミングで実施します)
    *   **Clerkセットアップ検討 (`project_todos.md` No. 53):**
        *   基本的なアカウント作成と、Next.jsへの導入方法のドキュメント確認などの初期調査を含め、本格的な実装は後続フェーズで行います。(注: 初期調査も一旦保留し、後続フェーズで対応します)
4.  **主要技術の技術検証 (PoC - Proof of Concept):**
    *   **Google Gemini API (`project_todos.md` No. 70):**
        *   APIキーを取得し、簡単なAPIコールが成功することを確認します。
    *   **LangChain (`project_todos.md` No. 71):**
        *   基本的なドキュメントローディング、テキスト分割、Embedding、LLM連携の動作を簡単なスクリプトで確認します。
        *   少量のサンプルテキスト（マニュアルの一部など）を用いて、Gemini APIと連携したQ&Aが期待通りに動作するか検証します。
    *   **Supabase `pgvector` (`project_todos.md` No. 67):**
        *   LangChainで生成したベクトルデータをSupabaseのPostgreSQLに保存し、類似度検索ができることを確認します。
5.  **UI/UX初期検討 (`project_todos.md` No. 5):**
    *   従業員向けチャット画面、管理者向けマニュアル一覧画面など、主要な画面の非常にシンプルなワイヤーフレームまたはペーパープロトタイプを作成し、基本的な操作フローのイメージを共有します。

## フェーズ 1: コア機能開発 (バックエンド中心 - Q&A基盤)

このフェーズの目標は、マニュアルをAIが理解し、質問応答できる状態にするバックエンドの仕組みを構築することです。

1.  **マニュアルデータの準備と格納 (`project_todos.md` No. 40 - 新規追加タスク):**
    *   初期検証用のマニュアルファイル（PDF、Word数点）を準備します。
    *   開発者が手動、または簡単なスクリプトを使用して、これらのファイルをSupabase Storageの指定バケットにアップロードします。
2.  **マニュアル処理パイプライン構築 (バックエンド):**
    *   **ドキュメントローディングとチャンク化:**
        *   Supabase Storageからマニュアルファイルを読み込み、LangChainのドキュメントローダーとテキストスプリッターを使って、意味のあるチャンクに分割する処理を実装します (Supabase Edge Functionなど)。
    *   **ベクトル化と保存:**
        *   分割されたチャンクをGemini API (or other embedding model) を使ってベクトル化し、メタデータ（ファイル名、チャンク位置など）と共にSupabase Database (`pgvector`) に保存する処理を実装します。
3.  **基本的なQ&A API実装 (バックエンド):**
    *   ユーザーからの質問を受け取り、質問文をベクトル化します。
    *   `pgvector` を使って、保存されているマニュアルのベクトルデータの中から類似度の高いチャンクを検索します。
    *   検索結果のチャンクと元の質問をプロンプトに含め、Gemini APIに投げて回答を生成させるAPIエンドポイントを作成します (Supabase Edge Functionなど)。
    *   回答と共に、参照元のマニュアル情報（ファイル名、該当箇所など）も返せるようにします (`project_todos.md` No. 35)。

## フェーズ 2: コア機能開発 (フロントエンド連携 - Q&A画面)

このフェーズの目標は、フェーズ1で構築したQ&A機能をユーザーが利用できる基本的なUIを実装することです。

1.  **従業員向けQ&AチャットUI実装 (`project_todos.md` No. 15):**
    *   Next.js, Tailwind CSS, shadcn/ui を使用して、シンプルなチャットインターフェースを作成します。
    *   ユーザーが質問を入力し、送信できるUIコンポーネントを実装します。
    *   AIからの回答と参照ソースを表示するエリアを実装します。
2.  **API連携:**
    *   フロントエンドからフェーズ1で作成したQ&A APIを呼び出し、結果を画面に表示する処理を実装します。

## フェーズ 3以降: 機能拡張と改善

コアとなるQ&A機能が動作するようになった後、以下の機能開発や改善を進めます。

*   **管理者向け機能:**
    *   マニュアルアップロードUI (`project_todos.md` No. 41)
    *   管理者作成メモ機能 (`project_todos.md` No. 23, 42)
    *   AIへの指示インターフェース（練習問題生成など） (`project_todos.md` No. 24, 45, 46)
*   **従業員向け機能:**
    *   管理者作成メモ閲覧 (`project_todos.md` No. 16)
    *   重要情報ワンタップアクセス (`project_todos.md` No. 17)
*   **UI/UX改善:**
    *   フェーズ0で作成したワイヤーフレームや初期UIに基づき、より詳細なデザインと操作性の改善を行います。
*   **その他:**
    *   介護専門用語辞書の本格導入 (`project_todos.md` No. 6, 36)
    *   多言語対応 (`project_todos.md` No. 59)
    *   ユーザー認証 (Clerk) の本格導入とアクセス制御 (`project_todos.md` No. 53, 54)
    *   データ管理ポリシー、利用規約整備 (`project_todos.md` No. 7)

このフローはあくまで初期案であり、プロジェクトの進捗や状況に応じて柔軟に見直していくことが重要です。 